(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{fb3c:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"flex column justify-start items-center"},[a("h1",{staticClass:"h1"},[t._v("Lista de Sites")]),a("SitesTable")],1)},n=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-lg",staticStyle:{"max-width":"90vw"}},[a("q-table",{staticClass:"my-sticky-column-table",staticStyle:{width:"100%"},attrs:{title:"Enlaces",data:t.data,columns:t.columns,"row-key":"_id",loading:t.loading,pagination:t.pagination,"binary-state-sort":""},on:{request:t.onRequestPaginate,"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top",fn:function(){return[a("q-btn",{staticClass:"q-mr-md",attrs:{color:"primary",disable:t.loading,label:"Registar Enlace"},on:{click:function(e){t.modalCreate=!0}}}),a("q-btn",{staticClass:"q-mr-md",attrs:{color:"primary",disable:t.loading,label:"Limpiar Busqueda"},on:{click:t.clearInputs}}),a("q-btn",{attrs:{color:"primary",disable:t.loading,label:"Descargar data"},on:{click:t.download}})]},proxy:!0},{key:"header",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-th",{attrs:{"auto-width":""}},[t._v("Opciones")]),t._l(e.cols,(function(o){return a("q-th",{key:o.name,attrs:{props:e}},[t._v(t._s(o.label))])}))],2)]}},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{attrs:{"auto-width":""}},[a("q-btn",{staticClass:"q-mr-sm",attrs:{size:"sm",color:"positive",round:"",dense:"",icon:"create"},on:{click:function(a){return t.openEditform(e.row)}}}),a("q-btn",{attrs:{size:"sm",color:"negative",round:"",dense:"",icon:"close"},on:{click:function(a){return t.openDeleteModal(e.row)}}})],1),t._l(e.cols,(function(o){return a("q-td",{key:o.name,attrs:{props:e}},[t._v(t._s(o.value))])}))],2),a("q-tr",{directives:[{name:"show",rawName:"v-show",value:e.expand,expression:"props.expand"}],staticClass:"col-",attrs:{props:e}},[a("q-td",{staticStyle:{"padding-left":"0"},attrs:{colspan:"100%"}},[a("DetailLink",{key:e.row._id,attrs:{link:e.row}})],1)],1)]}},{key:"bottom-row",fn:function(){return[a("q-tr",[a("q-td",{attrs:{"auto-width":""}}),t._l(t.columns,(function(e){return a("q-td",{key:e.name,attrs:{"auto-width":""}},[a("q-input",{staticStyle:{"min-width":"150px"},attrs:{dense:"",filled:""},on:{input:function(a){return t.updateInput(a,e.name)}},model:{value:t.body[e.name],callback:function(a){t.$set(t.body,e.name,a)},expression:"body[col.name]"}})],1)}))],2)]},proxy:!0}])}),a("q-dialog",{attrs:{persistent:""},model:{value:t.modalCharge,callback:function(e){t.modalCharge=e},expression:"modalCharge"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Cargando")])]),a("q-card-section",{staticClass:"q-pt-none flex column items-center justify-center"},[a("q-spinner-bars",{attrs:{color:"primary",size:"5.5em"}}),a("p",[t._v("por favor no cierre la pesta침a.")])],1)],1)],1),a("q-dialog",{attrs:{position:"top",seamless:"",persistent:""},model:{value:t.modalError,callback:function(e){t.modalError=e},expression:"modalError"}},[a("q-card",[a("q-card-section",{staticClass:"text-red"},[t._v("\n          Al parecer hubo un error realizando la operaci칩n\n          "),a("q-icon",{staticClass:"text-red",staticStyle:{"font-size":"2rem"},attrs:{name:"warning"}})],1)],1)],1),a("q-dialog",{attrs:{position:"top",seamless:"",persistent:""},model:{value:t.modalOk,callback:function(e){t.modalOk=e},expression:"modalOk"}},[a("q-card",[a("q-card-section",{staticClass:"text-green-5"},[t._v("\n          Operaci칩n Realizada con exito\n          "),a("q-icon",{staticClass:"text-green-5",staticStyle:{"font-size":"2rem"},attrs:{name:"check_circle"}})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.modalConfirmDelete,callback:function(e){t.modalConfirmDelete=e},expression:"modalConfirmDelete"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"warning",color:"negative","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[t._v("Est치s seguro de que deseas eliminar este enlace?")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"primary"}}),a("q-btn",{attrs:{flat:"",label:"Confirmar",color:"primary"},on:{click:t.deleteLink}})],1)],1)],1),a("FormCreate",{attrs:{layout:t.modalCreate},on:{onClose:function(e){t.modalCreate=!1},onSuccess:function(e){return t.alertar(!1)},onError:function(e){return t.alertar(!0)}}}),a("FormEdit",{attrs:{layout:t.modalEdit,form:t.linkEdit},on:{onClose:function(e){t.modalEdit=!1},onSuccess:function(e){return t.alertar(!1)},onError:function(e){return t.alertar(!0)}}})],1)},s=[],l=(a("68e1"),a("c8ef")),r=a.n(l),d=a("7c57"),c=a.n(d),u=a("94ea"),m=a("4e22"),p=a.n(m),g=a("a3c0"),h=a("52cb"),b=a("3231"),f={name:"MainSiteTable",components:{FormCreate:g["a"],DetailLink:b["a"],FormEdit:h["a"]},data(){return{select:{statusOptions:["Todos","danger","warning","ok","observado","sin-instancia"],mediaOptions:["Todos","BH","LH","FO","RENTADO-FO"]},typing:null,body:{sourceSite:null,sinkSite:null,utilization:null,media:"Todos",capacity:null,instanceName:null,status:"Todos"},loading:!0,pagination:{page:1,rowsPerPage:5,rowsNumber:0},columns:[{name:"siteName",label:"Site Name",field:t=>t.siteName,align:"left",sortable:!0},{name:"agg",label:"Agregador",field:t=>t.agg,sortable:!0},{name:"Coord-X",label:"Coord - X",field:t=>t.coordX,sortable:!0},{name:"Coord-Y",label:"Coord - Y",field:t=>t.coordY,sortable:!0},{name:"azimuth",label:"Azimuth",field:t=>t.azimuth,sortable:!0}],data:[],modalFile:!1,modalCharge:!1,file:null,modalCreate:!1,modalEdit:!1,modalError:!1,modalOk:!1,modalConfirmDelete:!1,linkEdit:null,linkDelete:null}},created(){const t=this.bodyBuilder(this.pagination);this.getData(t)},methods:{getData(){var t=this;return c()((function*(){const e=yield t.$axios.get(t.SITES_URL+"/getAllSite");return console.log("hace el page"),console.log(t.pagination),e.data.forEach(e=>{e.geometry&&t.data.push({siteName:e.siteName||"",agg:e.agg||"",coordX:e.geometry.coordinates[0]||"",coordY:e.geometry.coordinates[1]||"",azimuth:"test"})}),t.pagination.rowsNumber=t.data.length,console.log(t.pagination),console.log("termino el for each"),console.log(t.data[0]),t.loading=!1,"ok"}))()},onRequestPaginate(t){this.loading=!0,t.pagination.descending=!t.pagination.descending;const e=this.bodyBuilder(t.pagination,this.body);this.getData(e),this.pagination.descending=!t.pagination.descending},bodyBuilder(t,e){return console.log(t),t.sortBy&&!0===t.descending?t.sort="utilization":t.sortBy&&!1===t.descending&&(t.sort="-utilization"),e?{pagination:t,fields:e}:{pagination:t}},updateInput(t,e){this.loading=!0,clearTimeout(this.typing),this.typing=setTimeout(()=>{this.body[e]=t;const a=this.bodyBuilder(this.pagination,this.body);this.getData(a)},500)},updateSelectStatus(t){this.loading=!0,this.body.status=t;const e=this.bodyBuilder(this.pagination,this.body);this.getData(e)},updateSelectMedia(t){this.loading=!0,this.body.media=t;const e=this.bodyBuilder(this.pagination,this.body);this.getData(e)},clearInputs(){this.body={sourceSite:null,sinkSite:null,utilization:null,media:"Todos",capacity:null,instanceName:null,status:"Todos"},this.pagination={page:1,rowsPerPage:5,rowsNumber:0,sortBy:"utilization",descending:!1};const t=this.bodyBuilder(this.pagination);this.getData(t)},openModal(t){console.log(t),this.dataModal=t,this.modalOpen=!0},alertar(t){var e=this;return c()((function*(){if(e.modalCreate=!1,e.modalEdit=!1,t)e.modalError=!0,setTimeout(()=>{e.modalError=!1},3e3);else{e.modalOk=!0;const t=e.bodyBuilder(e.pagination);yield e.getData(t),setTimeout(()=>{e.modalOk=!1},3e3)}}))()},deleteLink(){var t=this;return c()((function*(){const{_id:e}=t.linkDelete;t.modalCharge=!0;yield t.$axios.delete(`${t.LINKS_URL}/${e}/deleteLink`,{enlace:t.linkDelete});const a=t.bodyBuilder(t.pagination);yield t.getData(a),t.modalCharge=!1,t.modalConfirmDelete=!1}))()},openEditform(t){this.linkEdit=t,this.modalEdit=!0},openDeleteModal(t){this.linkDelete=t,this.modalConfirmDelete=!0},download(){window.open(this.LINKS_URL+"/getData","_blank")},processUtilization(t){if(t.utilizationHistory&&t.utilizationHistory.length>0){let e="";const a=[p()().month(),p()().subtract(1,"months").month(),p()().subtract(2,"months").month(),p()().subtract(3,"months").month()];for(let o=0;o<4;o++)e+=` ${this.getMaxUtilizationbyMonth(t.utilizationHistory,a[o])} `;return e}return""},getMaxUtilizationbyMonth(t,e){const a=t.filter(t=>p()(t.date).month()==e),o=a.sort((t,e)=>e.maxUtilization-t.maxUtilization);return o.length>0?o[0].maxUtilization.toFixed(2):""}},computed:r()({},Object(u["b"])("links",["SITES_URL"]))},y=f,q=a("a6c2"),k=a("3846"),C=a("ef9c"),v=a("3bc2"),w=a("8e7e"),x=a("7b08"),S=a("a3be"),E=a("ec6d"),_=a("5ce7"),D=a("7006"),z=a("e9ee"),T=a("19dc"),O=a("d6e3"),B=a("84df"),N=a("f6b1"),L=a("63c1"),Q=a.n(L),I=Object(q["a"])(y,i,s,!1,null,"5f498222",null),M=I.exports;Q()(I,"components",{QTable:k["a"],QBtn:C["a"],QTr:v["a"],QTh:w["a"],QTd:x["a"],QInput:S["a"],QDialog:E["a"],QCard:_["a"],QCardSection:D["a"],QSpinnerBars:z["a"],QIcon:T["a"],QAvatar:O["a"],QCardActions:B["a"]}),Q()(I,"directives",{ClosePopup:N["a"]});var U={components:{SitesTable:M},name:"PageSites"},P=U,R=a("505d"),F=Object(q["a"])(P,o,n,!1,null,null,null);e["default"]=F.exports;Q()(F,"components",{QPage:R["a"]})}}]);