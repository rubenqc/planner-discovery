(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"6e10":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-page",{staticClass:"flex column justify-start items-center"},[e("h1",{staticClass:"h1"},[t._v("Lista de Sites")]),e("SitesTable")],1)},n=[],i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"q-pa-lg",staticStyle:{"max-width":"90vw"}},[e("q-table",{staticClass:"my-sticky-column-table",staticStyle:{width:"100%"},attrs:{title:"Enlaces",data:t.data,columns:t.columns,"row-key":"_id",loading:t.loading,pagination:t.pagination,"binary-state-sort":""},on:{request:t.onRequestPaginate,"update:pagination":function(a){t.pagination=a}},scopedSlots:t._u([{key:"top",fn:function(){return[e("q-btn",{staticClass:"q-mr-md",attrs:{color:"primary",disable:t.loading,label:"Registar Enlace"},on:{click:function(a){t.modalCreate=!0}}}),e("q-btn",{staticClass:"q-mr-md",attrs:{color:"primary",disable:t.loading,label:"Limpiar Busqueda"},on:{click:t.clearInputs}})]},proxy:!0},{key:"header",fn:function(a){return[e("q-tr",{attrs:{props:a}},[e("q-th",{attrs:{"auto-width":""}},[t._v("Opciones")]),t._l(a.cols,(function(o){return e("q-th",{key:o.name,attrs:{props:a}},[t._v(t._s(o.label))])}))],2)]}},{key:"body",fn:function(a){return[e("q-tr",{attrs:{props:a}},[e("q-td",{attrs:{"auto-width":""}},[e("q-btn",{staticClass:"q-mr-sm",attrs:{size:"sm",color:"positive",round:"",dense:"",icon:"create"},on:{click:function(e){return t.openEditform(a.row)}}}),e("q-btn",{attrs:{size:"sm",color:"negative",round:"",dense:"",icon:"close"},on:{click:function(e){return t.openDeleteModal(a.row)}}})],1),t._l(a.cols,(function(o){return e("q-td",{key:o.name,attrs:{props:a}},[t._v(t._s(o.value))])}))],2),e("q-tr",{directives:[{name:"show",rawName:"v-show",value:a.expand,expression:"props.expand"}],staticClass:"col-",attrs:{props:a}},[e("q-td",{staticStyle:{"padding-left":"0"},attrs:{colspan:"100%"}},[e("DetailLink",{key:a.row._id,attrs:{link:a.row}})],1)],1)]}},{key:"bottom-row",fn:function(){return[e("q-tr",[e("q-td",{attrs:{"auto-width":""}}),t._l(t.columns,(function(a){return e("q-td",{key:a.name,attrs:{"auto-width":""}},[e("q-input",{staticStyle:{"min-width":"140px"},attrs:{dense:"",filled:""},on:{input:function(e){return t.updateInput(e,a.name)}},model:{value:t.body[a.name],callback:function(e){t.$set(t.body,a.name,e)},expression:"body[col.name]"}})],1)}))],2)]},proxy:!0}])}),e("q-dialog",{attrs:{persistent:""},model:{value:t.modalCharge,callback:function(a){t.modalCharge=a},expression:"modalCharge"}},[e("q-card",[e("q-card-section",[e("div",{staticClass:"text-h6"},[t._v("Cargando")])]),e("q-card-section",{staticClass:"q-pt-none flex column items-center justify-center"},[e("q-spinner-bars",{attrs:{color:"primary",size:"5.5em"}}),e("p",[t._v("por favor no cierre la pesta침a.")])],1)],1)],1),e("q-dialog",{attrs:{position:"top",seamless:"",persistent:""},model:{value:t.modalError,callback:function(a){t.modalError=a},expression:"modalError"}},[e("q-card",[e("q-card-section",{staticClass:"text-red"},[t._v("\n          Al parecer hubo un error realizando la operaci칩n\n          "),e("q-icon",{staticClass:"text-red",staticStyle:{"font-size":"2rem"},attrs:{name:"warning"}})],1)],1)],1),e("q-dialog",{attrs:{position:"top",seamless:"",persistent:""},model:{value:t.modalOk,callback:function(a){t.modalOk=a},expression:"modalOk"}},[e("q-card",[e("q-card-section",{staticClass:"text-green-5"},[t._v("\n          Operaci칩n Realizada con exito\n          "),e("q-icon",{staticClass:"text-green-5",staticStyle:{"font-size":"2rem"},attrs:{name:"check_circle"}})],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.modalConfirmDelete,callback:function(a){t.modalConfirmDelete=a},expression:"modalConfirmDelete"}},[e("q-card",[e("q-card-section",{staticClass:"row items-center"},[e("q-avatar",{attrs:{icon:"warning",color:"negative","text-color":"white"}}),e("span",{staticClass:"q-ml-sm"},[t._v("Est치s seguro de que deseas eliminar este enlace?")])],1),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"primary"}}),e("q-btn",{attrs:{flat:"",label:"Confirmar",color:"primary"},on:{click:t.deleteLink}})],1)],1)],1),e("FormCreate",{attrs:{layout:t.modalCreate},on:{onClose:function(a){t.modalCreate=!1},onSuccess:function(a){return t.alertar(!1)},onError:function(a){return t.alertar(!0)}}}),e("FormEdit",{attrs:{layout:t.modalEdit,form:t.linkEdit},on:{onClose:function(a){t.modalEdit=!1},onSuccess:function(a){return t.alertar(!1)},onError:function(a){return t.alertar(!0)}}})],1)},s=[],l=(e("4e82"),e("ded3")),r=e.n(l),d=e("c973"),c=e.n(d),u=e("2f62"),m=e("c1df"),p=e.n(m),g=e("9108"),b=e("8a61"),h=e("a279"),f={name:"MainSiteTable",components:{FormCreate:g["a"],DetailLink:h["a"],FormEdit:b["a"]},data(){return{select:{statusOptions:["Todos","danger","warning","ok","observado","sin-instancia"],mediaOptions:["Todos","BH","LH","FO","RENTADO-FO"]},typing:null,body:{siteName:null,coordX:null,coordY:null,agg:null},loading:!0,pagination:{page:1,rowsPerPage:5,rowsNumber:0},columns:[{name:"siteName",label:"Site Name",field:t=>t.siteName,align:"left",sortable:!0},{name:"agg",label:"Agregador",field:t=>t.agg,sortable:!0},{name:"coordX",label:"Longitud",field:t=>t.coordX,sortable:!0},{name:"coordY",label:"Latitud",field:t=>t.coordY,sortable:!0}],data:[],modalFile:!1,modalCharge:!1,file:null,modalCreate:!1,modalEdit:!1,modalError:!1,modalOk:!1,modalConfirmDelete:!1,linkEdit:null,linkDelete:null}},created(){const t=this.bodyBuilder(this.pagination);console.log("-------body inicial----------"),console.log(t),this.getData(t)},methods:{getData(t={}){var a=this;return c()((function*(){const e=yield a.$axios.post(a.SITES_URL+"/getAllSite",r()({},t));return console.log("***** imprimiendo result de getData*********"),console.log(e),a.pagination.page=e.data.page,a.pagination.rowsPerPage=e.data.limit,a.pagination.rowsNumber=e.data.totalDocs,a.data=[],console.log(a.pagination),e.data.docs.forEach(t=>{a.data.push({siteName:t.siteName||"",agg:t.agg||"",coordX:t.geometry?t.geometry.coordinates[0]:"",coordY:t.geometry?t.geometry.coordinates[1]:""})}),console.log(a.data),a.pagination.sortBy=void 0,a.pagination.descending=void 0,a.loading=!1,"ok"}))()},onRequestPaginate(t){this.loading=!0,t.pagination.descending=!t.pagination.descending;const a=this.bodyBuilder(t.pagination,this.body);this.getData(a),this.pagination.descending=!t.pagination.descending},bodyBuilder(t,a){return console.log("--------- Imprimiendo pagination en builder--------"),console.log(t),a?{pagination:t,fields:a}:{pagination:t}},updateInput(t,a){this.loading=!0,clearTimeout(this.typing),this.typing=setTimeout(()=>{this.body[a]=t;const e=this.bodyBuilder(this.pagination,this.body);this.getData(e)},500)},updateSelectStatus(t){this.loading=!0,this.body.status=t;const a=this.bodyBuilder(this.pagination,this.body);this.getData(a)},updateSelectMedia(t){this.loading=!0,this.body.media=t;const a=this.bodyBuilder(this.pagination,this.body);this.getData(a)},clearInputs(){this.body={siteName:null,longitud:null,latitud:null,agregador:null},this.pagination={page:1,rowsPerPage:5,rowsNumber:0};const t=this.bodyBuilder(this.pagination);this.getData(t)},openModal(t){console.log(t),this.dataModal=t,this.modalOpen=!0},alertar(t){var a=this;return c()((function*(){if(a.modalCreate=!1,a.modalEdit=!1,t)a.modalError=!0,setTimeout(()=>{a.modalError=!1},3e3);else{a.modalOk=!0;const t=a.bodyBuilder(a.pagination);yield a.getData(t),setTimeout(()=>{a.modalOk=!1},3e3)}}))()},deleteLink(){var t=this;return c()((function*(){const{_id:a}=t.linkDelete;t.modalCharge=!0;yield t.$axios.delete(`${t.LINKS_URL}/${a}/deleteLink`,{enlace:t.linkDelete});const e=t.bodyBuilder(t.pagination);yield t.getData(e),t.modalCharge=!1,t.modalConfirmDelete=!1}))()},openEditform(t){this.linkEdit=t,this.modalEdit=!0},openDeleteModal(t){this.linkDelete=t,this.modalConfirmDelete=!0},download(){window.open(this.LINKS_URL+"/getData","_blank")},getMaxUtilizationbyMonth(t,a){const e=t.filter(t=>p()(t.date).month()==a);e.sort((t,a)=>a.maxUtilization-t.maxUtilization);return""}},computed:r()({},Object(u["b"])("links",["SITES_URL"]))},y=f,q=e("2877"),k=e("eaac"),C=e("9c40"),v=e("bd08"),w=e("357e"),E=e("db86"),x=e("27f9"),D=e("24e8"),_=e("f09f"),S=e("a370"),O=e("a154"),L=e("0016"),T=e("cb32"),N=e("4b7e"),B=e("7f67"),Q=e("eebe"),I=e.n(Q),P=Object(q["a"])(y,i,s,!1,null,"39a8733e",null),z=P.exports;I()(P,"components",{QTable:k["a"],QBtn:C["a"],QTr:v["a"],QTh:w["a"],QTd:E["a"],QInput:x["a"],QDialog:D["a"],QCard:_["a"],QCardSection:S["a"],QSpinnerBars:O["a"],QIcon:L["a"],QAvatar:T["a"],QCardActions:N["a"]}),I()(P,"directives",{ClosePopup:B["a"]});var R={components:{SitesTable:z},name:"PageSites"},M=R,F=e("9989"),U=Object(q["a"])(M,o,n,!1,null,null,null);a["default"]=U.exports;I()(U,"components",{QPage:F["a"]})}}]);