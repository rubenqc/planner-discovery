(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"2c9d":function(t,a,e){"use strict";var i=e("d0d1"),n=e.n(i);n.a},"2ccb":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-page",{staticClass:"flex column justify-start items-center"},[e("h1",{staticClass:"h1"},[t._v("Lista de Enlaces")]),e("LinkTable")],1)},n=[],o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"q-pa-lg",staticStyle:{"max-width":"90vw"}},[e("q-table",{staticClass:"my-sticky-column-table",staticStyle:{width:"100%"},attrs:{title:"Enlaces",data:t.data,columns:t.columns,"row-key":"_id",pagination:t.pagination,loading:t.loading,"binary-state-sort":""},on:{"update:pagination":function(a){t.pagination=a},request:t.onRequestPaginate},scopedSlots:t._u([{key:"top",fn:function(){return[e("q-btn",{staticClass:"q-mr-md",attrs:{color:"primary",disable:t.loading,label:"Registar Enlace"},on:{click:function(a){t.modalCreate=!0}}}),e("q-btn",{staticClass:"q-mr-md",attrs:{color:"primary",disable:t.loading,label:"Limpiar Busqueda"},on:{click:t.clearInputs}}),e("q-btn",{staticClass:"q-mr-md",attrs:{color:"primary",disable:t.loading,label:"Cargar Archivo Excel"},on:{click:function(a){t.modalFile=!0}}}),e("q-btn",{attrs:{color:"primary",disable:t.loading,label:"Descargar data"},on:{click:t.download}})]},proxy:!0},{key:"header",fn:function(a){return[e("q-tr",{attrs:{props:a}},[e("q-th",{attrs:{"auto-width":""}},[t._v("Opciones")]),t._l(a.cols,(function(i){return e("q-th",{key:i.name,attrs:{props:a}},[t._v(t._s(i.label))])}))],2)]}},{key:"body",fn:function(a){return[e("q-tr",{attrs:{props:a}},[e("q-td",{attrs:{"auto-width":""}},[e("q-btn",{staticClass:"q-mr-sm",attrs:{size:"sm",color:"primary",round:"",dense:"",icon:a.expand?"keyboard_arrow_up":"expand_more"},on:{click:function(t){a.expand=!a.expand}}}),e("q-btn",{staticClass:"q-mr-sm",attrs:{size:"sm",color:"positive",round:"",dense:"",icon:"create"},on:{click:function(e){return t.openEditform(a.row)}}}),e("q-btn",{attrs:{size:"sm",color:"negative",round:"",dense:"",icon:"close"},on:{click:function(e){return t.openDeleteModal(a.row)}}})],1),t._l(a.cols,(function(i){return e("q-td",{key:i.name,attrs:{props:a}},[t._v(t._s(i.value))])}))],2),e("q-tr",{directives:[{name:"show",rawName:"v-show",value:a.expand,expression:"props.expand"}],staticClass:"col-",attrs:{props:a}},[e("q-td",{staticStyle:{"padding-left":"0"},attrs:{colspan:"100%"}},[e("DetailLink",{key:a.row._id,attrs:{link:a.row}})],1)],1)]}},{key:"bottom-row",fn:function(){return[e("q-tr",[e("q-td",{attrs:{"auto-width":""}}),t._l(t.columns,(function(a){return e("q-td",{key:a.name,attrs:{"auto-width":""}},["status"===a.name?e("q-select",{staticStyle:{"min-width":"150px"},attrs:{dense:"",filled:"",options:t.select.statusOptions},on:{input:t.updateSelectStatus},model:{value:t.body.status,callback:function(a){t.$set(t.body,"status",a)},expression:"body.status"}}):"media"===a.name?e("q-select",{staticStyle:{"min-width":"150px"},attrs:{dense:"",filled:"",options:t.select.mediaOptions},on:{input:t.updateSelectMedia},model:{value:t.body.media,callback:function(a){t.$set(t.body,"media",a)},expression:"body.media"}}):e("q-input",{staticStyle:{"min-width":"150px"},attrs:{dense:"",filled:""},on:{input:function(e){return t.updateInput(e,a.name)}},model:{value:t.body[a.name],callback:function(e){t.$set(t.body,a.name,e)},expression:"body[col.name]"}})],1)}))],2)]},proxy:!0}])}),e("q-dialog",{attrs:{persistent:""},model:{value:t.modalFile,callback:function(a){t.modalFile=a},expression:"modalFile"}},[e("q-card",{staticStyle:{"min-width":"350px"}},[e("form",{attrs:{enctype:"multipart/form-data"},on:{submit:function(a){return a.preventDefault(),t.uploadExcel(a)}}},[e("q-card-section",[e("div",{staticClass:"text-h6"},[t._v("SmartCapex")])]),e("q-card-section",{staticClass:"q-pt-none"},[e("q-file",{attrs:{filled:"","bottom-slots":"",label:"Seleccione",name:"excel",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","max-files":"1"},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{attrs:{name:"attach_file"},on:{click:function(t){t.stopPropagation()}}})]},proxy:!0},{key:"append",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(a){a.stopPropagation(),t.file=null}}})]},proxy:!0}]),model:{value:t.file,callback:function(a){t.file=a},expression:"file"}})],1),e("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",type:"submit",label:"Subir Archivo"}})],1)],1)])],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.modalCharge,callback:function(a){t.modalCharge=a},expression:"modalCharge"}},[e("q-card",[e("q-card-section",[e("div",{staticClass:"text-h6"},[t._v("Cargando")])]),e("q-card-section",{staticClass:"q-pt-none flex column items-center justify-center"},[e("q-spinner-bars",{attrs:{color:"primary",size:"5.5em"}}),e("p",[t._v("por favor no cierre la pestaña.")])],1)],1)],1),e("q-dialog",{attrs:{position:"top",seamless:"",persistent:""},model:{value:t.modalError,callback:function(a){t.modalError=a},expression:"modalError"}},[e("q-card",[e("q-card-section",{staticClass:"text-red"},[t._v("\n        Al parecer hubo un error realizando la operación\n        "),e("q-icon",{staticClass:"text-red",staticStyle:{"font-size":"2rem"},attrs:{name:"warning"}})],1)],1)],1),e("q-dialog",{attrs:{position:"top",seamless:"",persistent:""},model:{value:t.modalOk,callback:function(a){t.modalOk=a},expression:"modalOk"}},[e("q-card",[e("q-card-section",{staticClass:"text-green-5"},[t._v("\n        Operación Realizada con exito\n        "),e("q-icon",{staticClass:"text-green-5",staticStyle:{"font-size":"2rem"},attrs:{name:"check_circle"}})],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.modalConfirmDelete,callback:function(a){t.modalConfirmDelete=a},expression:"modalConfirmDelete"}},[e("q-card",[e("q-card-section",{staticClass:"row items-center"},[e("q-avatar",{attrs:{icon:"warning",color:"negative","text-color":"white"}}),e("span",{staticClass:"q-ml-sm"},[t._v("Estás seguro de que deseas eliminar este enlace?")])],1),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"primary"}}),e("q-btn",{attrs:{flat:"",label:"Confirmar",color:"primary"},on:{click:t.deleteLink}})],1)],1)],1),e("FormCreate",{attrs:{layout:t.modalCreate},on:{onClose:function(a){t.modalCreate=!1},onSuccess:function(a){return t.alertar(!1)},onError:function(a){return t.alertar(!0)}}}),e("FormEdit",{attrs:{layout:t.modalEdit,form:t.linkEdit},on:{onClose:function(a){t.modalEdit=!1},onSuccess:function(a){return t.alertar(!1)},onError:function(a){return t.alertar(!0)}}})],1)},l=[],s=(e("68e1"),e("5e5b"),e("534d"),e("c8ef")),r=e.n(s),d=e("7c57"),c=e.n(d),u=e("94ea"),p=e("4e22"),m=e.n(p),g=e("a3c0"),f=e("52cb"),b=e("3231"),h={name:"MainTable",components:{FormCreate:g["a"],DetailLink:b["a"],FormEdit:f["a"]},data(){return{select:{statusOptions:["Todos","danger","warning","ok","observado","sin-instancia"],mediaOptions:["Todos","BH","LH","FO","RENTADO-FO"]},typing:null,body:{sourceSite:null,sinkSite:null,utilization:null,media:"Todos",capacity:null,instanceName:null,status:"Todos"},loading:!0,pagination:{page:1,rowsPerPage:5,rowsNumber:0,sortBy:"utilization",descending:!1},columns:[{name:"sourceSite",label:"Source Site",field:t=>t.nearEnd.name,align:"left"},{name:"sinkSite",label:"Sink Site",field:t=>t.farEnd.name,align:"left"},{name:"status",label:"Estado",field:"status",align:"left"},{name:"utilization",label:"Utilización (%)",field:"lastMaxutilization",align:"left",sortable:!0},{name:"media",label:"Medio",field:"media",align:"left"},{name:"capacity",label:"Capacidad",field:"capacity",align:"left"},{name:"instanceName",label:"Nombre de Instancia",field:"instanceName",align:"left"},{name:"forecastDate",label:"Fecha de Forecast",field:"forecastDate",align:"left"},{name:"updatedDate",label:"Fecha de Actualización",field:"updatedDate",align:"left"},{name:"typeVisualization",label:"Tipo de visualización",field:"typeVisualization",align:"left"},{name:"stageVisualization",label:"Estación de visualización",field:"stageVisualization",align:"left"}],data:[],modalFile:!1,modalCharge:!1,file:null,modalCreate:!1,modalEdit:!1,modalError:!1,modalOk:!1,modalConfirmDelete:!1,linkEdit:null,linkDelete:null}},created(){const t=this.bodyBuilder(this.pagination);this.getData(t)},methods:{getData(t={}){var a=this;return c()((function*(){const e=yield a.$axios.post(a.LINKS_URL+"/listByQuery",r()({},t));return a.data.splice(0,a.data.length,...e.data.docs),a.pagination.page=e.data.page,a.pagination.rowsPerPage=e.data.limit,a.pagination.rowsNumber=e.data.totalDocs,t.pagination.sort&&"utilization"===t.pagination.sort||t.pagination.sort&&"-utilization"===t.pagination.sort?a.pagination.sortBy="utilization":(a.pagination.sortBy=void 0,a.pagination.descending=void 0),a.loading=!1,"ok"}))()},onRequestPaginate(t){this.loading=!0,t.pagination.descending=!t.pagination.descending;const a=this.bodyBuilder(t.pagination,this.body);this.getData(a),this.pagination.descending=!t.pagination.descending},bodyBuilder(t,a){return console.log(t),t.sortBy&&!0===t.descending?t.sort="utilization":t.sortBy&&!1===t.descending&&(t.sort="-utilization"),a?{pagination:t,fields:a}:{pagination:t}},updateInput(t,a){this.loading=!0,clearTimeout(this.typing),this.typing=setTimeout(()=>{this.body[a]=t;const e=this.bodyBuilder(this.pagination,this.body);this.getData(e)},500)},updateSelectStatus(t){this.loading=!0,this.body.status=t;const a=this.bodyBuilder(this.pagination,this.body);this.getData(a)},updateSelectMedia(t){this.loading=!0,this.body.media=t;const a=this.bodyBuilder(this.pagination,this.body);this.getData(a)},clearInputs(){this.body={sourceSite:null,sinkSite:null,utilization:null,media:"Todos",capacity:null,instanceName:null,status:"Todos"},this.pagination={page:1,rowsPerPage:5,rowsNumber:0,sortBy:"utilization",descending:!1};const t=this.bodyBuilder(this.pagination);this.getData(t)},openModal(t){console.log(t),this.dataModal=t,this.modalOpen=!0},uploadExcel(t){var a=this;return c()((function*(){a.modalCharge=!0;const e=new FormData(t.target),i=(yield a.$axios.post(a.LINKS_URL+"/uploadExcel",e),a.bodyBuilder(a.pagination));yield a.getData(i),a.modalCharge=!1}))()},alertar(t){var a=this;return c()((function*(){if(a.modalCreate=!1,a.modalEdit=!1,t)a.modalError=!0,setTimeout(()=>{a.modalError=!1},3e3);else{a.modalOk=!0;const t=a.bodyBuilder(a.pagination);yield a.getData(t),setTimeout(()=>{a.modalOk=!1},3e3)}}))()},deleteLink(){var t=this;return c()((function*(){const{_id:a}=t.linkDelete;t.modalCharge=!0;yield t.$axios.delete(`${t.LINKS_URL}/${a}/deleteLink`,{enlace:t.linkDelete});const e=t.bodyBuilder(t.pagination);yield t.getData(e),t.modalCharge=!1,t.modalConfirmDelete=!1}))()},openEditform(t){this.linkEdit=t,this.modalEdit=!0},openDeleteModal(t){this.linkDelete=t,this.modalConfirmDelete=!0},download(){var t=this;return c()((function*(){window.open(t.LINKS_URL+"/getData","_blank")}))()},processUtilization(t){if(t.utilizationHistory&&t.utilizationHistory.length>0){let a="";const e=[m()().month(),m()().subtract(1,"months").month(),m()().subtract(2,"months").month(),m()().subtract(3,"months").month()];for(let i=0;i<4;i++)a+=` ${this.getMaxUtilizationbyMonth(t.utilizationHistory,e[i])} `;return a}return""},getMaxUtilizationbyMonth(t,a){const e=t.filter(t=>m()(t.date).month()==a),i=e.sort((t,a)=>a.maxUtilization-t.maxUtilization);return i.length>0?i[0].maxUtilization.toFixed(2):""}},computed:r()({},Object(u["b"])("links",["LINKS_URL"]))},y=h,q=(e("2c9d"),e("a6c2")),k=e("3846"),v=e("ef9c"),x=e("3bc2"),C=e("8e7e"),w=e("7b08"),S=e("f636"),z=e("a3be"),D=e("ec6d"),E=e("5ce7"),_=e("7006"),B=e("af15"),L=e("19dc"),O=e("84df"),T=e("e9ee"),N=e("d6e3"),F=e("f6b1"),Q=e("63c1"),I=e.n(Q),M=Object(q["a"])(y,o,l,!1,null,null,null),P=M.exports;I()(M,"components",{QTable:k["a"],QBtn:v["a"],QTr:x["a"],QTh:C["a"],QTd:w["a"],QSelect:S["a"],QInput:z["a"],QDialog:D["a"],QCard:E["a"],QCardSection:_["a"],QFile:B["a"],QIcon:L["a"],QCardActions:O["a"],QSpinnerBars:T["a"],QAvatar:N["a"]}),I()(M,"directives",{ClosePopup:F["a"]});var U={components:{LinkTable:P},name:"PageIndex"},$=U,R=e("505d"),A=Object(q["a"])($,i,n,!1,null,null,null);a["default"]=A.exports;I()(A,"components",{QPage:R["a"]})},d0d1:function(t,a,e){}}]);